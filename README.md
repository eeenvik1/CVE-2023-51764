# PoC for CVE-2023-51764 SMTP SMUGGLING Postfix


## CVE-2023-51765_25.py

### Описание

Данный скрипт позволяет отправлять сообщения, используя 25 порт почтового сервера.

### Использование

Перед запуском, необходимо изменить переменные:
* `smtp_server` - адрес почтового сервера
* `from_address` - отправитель первого письма
* `to_address` - получатель первого письма
* `username` - логин для прохождения авторизации
* `password` - пароль для прохождения авторизации
* `body` - сообщение
* * В теле сообщения есть две переменные
  * `mail FROM` - адрес ложного отправителя
  * `rcpt TO` - адрес действительного получателя
 
Запускать командой: `python3 CVE-2023-51765_25.py`

### Вывод работы скрипта

![](https://github.com/eeenvik1/CVE-2023-51764/blob/main/Screenshots/Screenshot_2.png)

### Доставленные сообщения

![](https://github.com/eeenvik1/CVE-2023-51764/blob/main/Screenshots/Screenshot_1.png)



## CVE-2023-51765_465.py

### Описание

Данный скрипт позволяет отправлять сообщения, используя 465 порт почтового сервера.

### Использование

Перед запуском, необходимо изменить переменные:
* `smtp_server` - адрес почтового сервера
* `from_address` - отправитель первого письма
* `to_address` - получатель первого письма
* `username` - логин для прохождения авторизации
* `password` - пароль для прохождения авторизации
* `body` - сообщение
* * В теле сообщения есть две переменные
  * `mail FROM` - адрес ложного отправителя
  * `rcpt TO` - адрес действительного получателя
 
Запускать командой: `python3 CVE-2023-51765_25.py`

### Вывод работы скрипта

![](https://github.com/eeenvik1/CVE-2023-51764/blob/main/Screenshots/Screenshot_4.png)

### Доставленные сообщения

![](https://github.com/eeenvik1/CVE-2023-51764/blob/main/Screenshots/Screenshot_3.png)
